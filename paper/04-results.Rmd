# Results {#sec:results}

## Real-Game Illustration of STRAIN

```{r}
#| label: fig_field
#| fig.cap: "A display of the player tracking data for a play during the Las Vegas Raiders (defense, in black) versus Denver Broncos (offense, in orange) NFL game on October 17, 2021. Raiders DE Maxx Crosby is highlighted in blue. For each Raiders defender, the point size indicates their individual STRAIN value, with larger points suggesting larger STRAIN. Snapshots are captured at 1, 2, 3, and 4 seconds after the ball snap."
#| fig.width: 6.6
#| fig.height: 4.4
source(here("scripts", "01_fig_field.R"))
fig_field
```


```{r}
#| label: fig_crosby_curves
#| fig.cap: "Changes in STRAIN, velocity, and distance from the QB for Maxx Crosby over the course of a successful pass rush play that results in a sack. The STRAIN for other pass rushers throughout this play is also displayed."
#| fig.width: 4.8
#| fig.height: 2.7
source(here("scripts", "02_fig_crosby_curves.R"))
fig_crosby_curves
```


To illustrate our proposed metric STRAIN for pass rush evaluation, we use the same play from the Las Vegas Raiders and Denver Broncos game as mentioned in Section \ref{sec:data}.
Figure \ref{fig:fig_field} shows an updated version of Figure \ref{fig:fig_field_raw}, with the point size for each Las Vegas defender corresponding to the estimated STRAIN in the selected frames as the play progresses.
This is accompanied by Figure \ref{fig:fig_crosby_curves}, which is a line graph showing how Crosby's distance from the quarterback, velocity, and STRAIN change continuously throughout the play.

We observe that for the first two seconds, Crosby is being blocked by a Denver offensive lineman and unable to get close to the quarterback, hence the corresponding STRAIN values are virtually zero. 
Suddenly at around three seconds after the snap, the STRAIN for Crosby starts to increase after the Raiders DE is freed up and charges towards Bridgewater. 
At 4 seconds after the snap, Crosby's STRAIN is 2.30, which means at his current moving rate, it will take Crosby about 0.43 (1/2.30) seconds to make the distance between him and the quarterback 0 (i.e. essentially sack the quarterback).
This matches well with the final outcome of the play, as the sack takes place at the very last frame (4.4 seconds) where the estimated STRAIN for Crosby reaches its peak at 3.96.

Moreover, Figure \ref{fig:fig_crosby_curves} clearly demonstrates the interactions between the features for Maxx Crosby.
Here, a higher STRAIN generally corresponds to faster moving rate towards the quarterback.
STRAIN also increases as the distance between the pass rusher and quarterback is being reduced.
Both of these relationships suggest an overall successful pass rush by Maxx Crosby.
It is also notable that Crosby, who is credited with a sack, generates more STRAIN than other pass rushers during this play.

In contrast, Figure \ref{fig:fig_crosby_curves_unsucess} shows the feature curves for an unsuccessful pass rush attempt by the Raiders defense from the same game.
In this play, Broncos QB Teddy Bridgewater is well-protected by the offensive line and is able to release a long pass[^unsuccess].
We see that the STRAIN generated by Crosby is relatively small over the course of this play, compared to the previous play shown in Figure \ref{fig:fig_crosby_curves} which results in a sack.

[^unsuccess]: A real-game footage of this play is available at https://www.nfl.com/videos/teddy-bridgewater-courtland-sutton-barely-miss-out-on-chance-at-62-yard-td-bomb


```{r}
#| label: fig_crosby_curves_unsucess
#| fig.cap: "Changes in STRAIN, velocity, and distance from the QB for Maxx Crosby over the course of an unsuccessful pass rush play. The STRAIN for other pass rushers throughout this play is also displayed."
#| fig.width: 4.8
#| fig.height: 2.7
source(here("scripts", "09_fig_play_unsuccess.R"))
fig_crosby_curves_unsucess
```

## Positional STRAIN curves {#sec:positional}

```{r}
#| label: fig_pos_curves
#| fig.cap: "STRAIN curves for different positions. Edge rushers (OLB and DE) tend to generate more STRAIN than interior rushers (DT and NT). The dotted gray line represents the average STRAIN curve for all players without accounting for position."
#| fig.width: 4.5
#| fig.height: 3
source(here("scripts", "03_fig_pos_curves.R"))
fig_pos_curves
```

```{r}
#| label: fig_outcome_curves
#| fig.cap: "Positional STRAIN curves by play outcome (sack, hit, hurry, and none)."
#| fig.width: 6.5
#| fig.height: 2.7
source(here("scripts", "08_fig_outcome_curves.R"))
fig_outcome_curves
```

Figure \ref{fig:fig_pos_curves} displays the average STRAIN by position for the first 40 frames (4 seconds) after the snap.
We observe a clear difference in STRAIN between edge rushers (OLB's and DE's) and interior linemen (DT's and NT's).
Specifically, edge rushers have higher STRAIN than interior linemen on average, as they are more easily able to approach the quarterback on the edge of the pocket versus, for instance, a nose tackle attacking the line head on.

On average, STRAIN appears to increase for the first 0.5 seconds of a play, followed by a decline in the next second.
STRAIN then increases again until around 2.5-3 seconds after the snap before trending down towards the end of the play.
In context, this reflects the actions that a pass rusher initially moves towards the quarterback, but is then stopped by the offensive line while the quarterback drops back.
When the quarterback stops dropping, the rusher closes the gap and increases STRAIN, before slowing down later on.

Further, Figure \ref{fig:fig_outcome_curves} shows the positional STRAIN curves by whether a play's outcome is a hit, sack, hurry, or none of those. 
We clearly see that players tend to generate more STRAIN when a play ends in a hit, sack, or hurry, compared to no outcome.
Within the three pressure metrics, it is not surprised that a sack corresponds to the highest amount of STRAIN, followed by a hit and hurry.

## Ranking the Best Pass Rushers {#sec:strainbar}

Since STRAIN is observed continuously for every play in our data, this allows us to aggregate across all frames played and compute the average STRAIN for NFL pass rushers over the course of the eight-week sample size, as discussed in Section \ref{sec:defn}.
Based on the clearly distinct patterns for different positions as previously observed, we evaluate interior pass rushers (NT's and DT's) separately from edge rushers (OLB's and DE's).
Tables \ref{tab:edge} and \ref{tab:interior} are leaderboards for the NFL's best edge and interior rushers (with at least 100 plays) rated by the average STRAIN across all frames for the first eight weeks of the 2021 regular season.
The tables also consist of the total number of hits, hurries, and sacks for each defender.

Our results show many true positives with no surprises.
Myles Garrett and TJ Watt are known as top-tier edge rushers, while Aaron Donald is undoubtedly the best interior defender in football.
Rashan Gary, a young rusher with huge potential, ranks first among all pass rushers according to our metric.
Moreover, our leaderboards largely match the rankings of experts in the field.
For instance, there is considerable overlap between our lists and PFF's edge [@Monson2022nfl] and interior [@Linsey2022nfl] rusher rankings released after the 2021 season.
This ultimately lends credibility to our proposed metric STRAIN as a measure of pass rushing effectiveness.

\begin{table}
\caption{Top 15 edge rushers (with at least 100 snaps played) according to the average STRAIN across all frames played. \label{tab:edge}}
\centering
\begin{tabular}{rlllrrrrr}
\hline
Rank & Player & Team & Position & Snaps & Hits & Hurries & Sacks & $\overline{\text{STRAIN}}$ \\
\hline
1 & Rashan Gary & GB & OLB & 176 & 10 & 25 & 5 & 2.82 \\ 
2 & Leonard Floyd & LA & OLB & 185 & 2 & 25 & 8 & 2.80 \\ 
3 & Justin Houston & BAL & OLB & 132 & 8 & 8 & 4 & 2.78 \\ 
4 & Myles Garrett & CLE & DE & 197 & 9 & 29 & 12 & 2.75 \\ 
5 & Von Miller & DEN & OLB & 145 & 4 & 21 & 5 & 2.75 \\ 
6 & T.J. Watt & PIT & OLB & 147 & 6 & 9 & 8 & 2.71 \\ 
7 & Yannick Ngakoue & LV & DE & 175 & 6 & 20 & 4 & 2.70 \\ 
8 & Alex Highsmith & PIT & OLB & 129 & 4 & 7 & 2 & 2.65 \\ 
9 & Preston Smith & GB & OLB & 124 & 4 & 8 & 2 & 2.61 \\ 
10 & Randy Gregory & DAL & DE & 134 & 7 & 19 & 5 & 2.58 \\ 
11 & Joey Bosa & LAC & OLB & 160 & 5 & 21 & 4 & 2.58 \\ 
12 & Darrell Taylor & SEA & DE & 107 & 5 & 9 & 3 & 2.57 \\ 
13 & Josh Sweat & PHI & DE & 159 & 4 & 14 & 5 & 2.57 \\ 
14 & Maxx Crosby & LV & DE & 198 & 12 & 30 & 7 & 2.56 \\ 
15 & Markus Golden & ARI & OLB & 164 & 5 & 14 & 5 & 2.50 \\ 
\hline
\end{tabular}
\end{table}



\begin{table}
\caption{Top 15 interior rushers (with at least 100 snaps played) according to the average STRAIN across all frames played. \label{tab:interior}}
\centering
\begin{tabular}{rlllrrrrr}
\hline
Rank & Player & Team & Position & Snaps & Hits & Hurries & Sacks & $\overline{\text{STRAIN}}$ \\
\hline
1 & Aaron Donald & LA & DT & 239 & 8 & 24 & 6 & 1.67 \\ 
2 & Solomon Thomas & LV & DT & 115 & 7 & 11 & 3 & 1.51 \\ 
3 & Quinton Jefferson & LV & DT & 144 & 6 & 8 & 3 & 1.46 \\ 
4 & Chris Jones & KC & DT & 139 & 3 & 18 & 3 & 1.42 \\ 
5 & DeForest Buckner & IND & DT & 198 & 4 & 18 & 4 & 1.26 \\ 
6 & Cameron Heyward & PIT & DT & 188 & 2 & 22 & 3 & 1.25 \\ 
7 & Javon Hargrave & PHI & DT & 156 & 6 & 15 & 5 & 1.24 \\ 
8 & Jerry Tillery & LAC & DT & 171 & 4 & 7 & 3 & 1.16 \\ 
9 & Ed Oliver & BUF & DT & 133 & 4 & 12 & 1 & 1.15 \\ 
10 & Osa Odighizuwa & DAL & DT & 162 & 3 & 18 & 3 & 1.13 \\ 
11 & Greg Gaines & LA & NT & 111 & 2 & 13 & 2 & 1.11 \\ 
12 & Leonard Williams & NYG & DT & 226 & 4 & 14 & 6 & 1.03 \\ 
13 & Christian Barmore & NE & DT & 166 & 5 & 17 & 1 & 1.02 \\ 
14 & Vita Vea & TB & NT & 184 & 6 & 12 & 1 & 1.01 \\ 
15 & B.J. Hill & CIN & DT & 123 & 3 & 4 & 3 & 0.96 \\ 
\hline
\end{tabular}
\end{table}


## Statistical Properties of STRAIN {#sec:statprop}

<!-- From @Franks2016Meta (github https://github.com/afranks86/meta-analytics) -->

<!--

Discrimination: Does the metric reliably differentiate between players?

Independence: Does the metric provide new information?

-->

Next, we examine different statistical properties of our proposed metric STRAIN.
Our focus here is to understand the stability and predictability of STRAIN, and we pose the following question:
How much does our metric vary from week to week?
In other words, is previous performance predictive of future performance based on our metric?
Below, we attempt the answer these questions, and the following results are for pass rushers with at least 100 snaps played during the first 8 weeks of the 2021 NFL regular season.

We first investigate the predictability of STRAIN as a measure of pressure.
In particular, we look at how well our metric correlates with a simple measure of pressure rate, defined as the total hits, sacks and hurries per snap.
Figure \ref{fig:fig_cor_pressure} is a scatterplot of average STRAIN and pressure rate over the course the provided 8-game sample, which reveals a fairly strong correlation ($r =0.625$) between the quantities.
Hence, defenders with high STRAIN values also tend to generate more pressure toward the quarterback.
Furthermore, the average STRAIN for the first 4 weeks of the 2021 season is more predictive of the last 4 weeks' pressure rate ($r=0.322$) than the first 4 weeks' pressure rate ($r=0.097$), as illustrated in Figure \ref{fig:fig_predictability}.

We also analyze the stability of STRAIN over time by comparing the average STRAIN across all frames played for the first and last four weeks of the 2021 NFL regular season.
It is apparent from Figure \ref{fig:fig_stability} that there is a strong positive correlation $(r = 0.854)$ for this relationship.
This means that STRAIN is a highly stable football metric over the provided 8-week time window, and pass rushers appear to carry their STRAIN values with them from week to week.
Overall, STRAIN performs well in both explaining defensive pressure on the field and predicting future performance of pass rushers.


```{r}
#| label: fig_cor_pressure
#| fig.cap: "Relationship between average STRAIN and pressure rate (total hits, sacks, and hurries per snap) over the first 8 weeks of the 2021 NFL season. There is a moderately strong association between average STRAIN and pressure rate ($r =0.625$). Results shown here are for pass rushers with at least 100 snaps play over the 8-week data."
#| fig.width: 4
#| fig.height: 3
source(here("scripts", "04_fig_cor_pressure.R"))
fig_cor_pressure
```

```{r}
#| label: fig_predictability
#| fig.cap: "Relationships between pressure rate for the last 4 weeks of the 2021 NFL season and first 4 weeks' pressure rate (left) and average STRAIN (right). STRAIN is more predictive ($r=0.322$) of future pressure rate than previous pressure rate itself ($r=0.097$). Results shown here are for pass rushers with at least 100 snaps play over the 8-week data."
#| fig.width: 6.5
#| fig.height: 3
#| fig.show: "hold"
source(here("scripts", "07_fig_predictability.R"))
fig_predictability
```

```{r}
#| label: fig_stability
#| fig.cap: "Relationship between average STRAIN for the last and first 4 weeks of the 2021 NFL season. A strong linear correlation ($r = 0.854$) demonstrates that STRAIN is a highly stable metric over time. Results shown here are for pass rushers with at least 100 snaps play over the 8-week data."
#| fig.width: 4
#| fig.height: 3
source(here("scripts", "05_fig_stability.R"))
fig_stability
```

## Multilevel Model Results

[CHECK/EDIT THIS, MAKE SURE WORDING IS CORRECT/NOT CONFUSING]

There are a variety of quantities we are interested in from the multilevel model fit mentioned in Section \ref{sec:methods}.
First, Table \ref{tab:fixedeff} displays the results for the fixed effects terms.
It appears that that the average STRAIN decreases by 0.042 (95% CI [-0.044, -0.040]) for every extra second in play length, and by 0.064 (95% CI [-0.069, -0.059]) every additional blocker in the offensive unit, after accounting for other covariates in the model.
In other words, NFL pass rushers tend to generate more pressure in plays with shorter length and when facing fewer number of blockers, which totally makes sense.

We observe statistically significant differences among the pass rush and pass block positions in most cases, while controlling for other variables.
The coefficient estimates for the pass rush position terms reveal that players with positions closer to the line of scrimmage (DT and NT) appear to generate less STRAIN (relative to DE) than those that are further back, which is consistent with our results in Section \ref{sec:positional}.
For blockers, centers are those that absorb the most pressure on average, more than guards and other offensive positions (compared to the baseline level, tackles).

<!-- [INSERT CONCLUSIONS ABOUT THESE VARIABLES] -->
<!-- [SAY SOMETHING ABOUT POSITION] -->

Next, Table \ref{tab:icc} displays the intraclass correlation coefficients (ICC) for the three different grouped terms, describing the proportion variance explained between the group terms in comparison to the residual variance.
While the residual variance is unsurprisingly the largest value, between the three group terms, we observe the largest ICC for pass rushers, followed by the QB, and the blocker.
This emphasizes how STRAIN is mostly attributable to pass rushers, but is necessary to adjust for opposition and other factors.

<!-- reference levels: DE (rush), T (block) -->

\begin{table}
\caption{Fixed-effects coefficient estimates for the multilevel model for average STRAIN. Note that the reference pass rusher level is defensive end (DE), denoted R:DE; and the reference pass blocker level is tackle (T), denoted B:T. \label{tab:fixedeff}}
\centering
\begin{tabular}{lrrrr}
\hline
& estimate & se & $t$-statistic & $p$-value \\ 
\hline
Intercept & 0.378 & 0.009 & 43.310 & 0.000 \\ 
Length of play & -0.042 & 0.001 & -38.214 & 0.000 \\
Number of blockers & -0.064 & 0.003 & -24.788 & 0.000 \\
$I_{\text{\{R:DT\}}}$ & -0.081 & 0.008 & -10.340 & 0.000 \\
$I_{\text{\{R:interior\}}}$ & 0.058 & 0.011 & 5.332 & 0.000 \\
$I_{\text{\{R:NT\}}}$ & -0.106 & 0.012 & -9.174 & 0.000 \\
$I_{\text{\{R:OLB\}}}$ & 0.062 & 0.008 & 7.695 & 0.000 \\
$I_{\text{\{R:secondary\}}}$ & 0.145 & 0.012 & 12.328 & 0.000 \\
$I_{\text{\{B:C\}}}$ & -0.023 & 0.006 & -3.625 & 0.000 \\
$I_{\text{\{B:G\}}}$ & -0.011 & 0.005 & -2.290 & 0.023 \\ 
$I_{\text{\{B:other\}}}$ & -0.013 & 0.007 & -1.911 & 0.056 \\
\hline
\end{tabular}
\end{table}

<!-- (Intercept) & 0.378 & 0.009 & 43.310 & 0.000 \\  -->
<!--   play\_len & -0.004 & 0.000 & -38.214 & 0.000 \\  -->
<!--   rush\_posDT & -0.081 & 0.008 & -10.340 & 0.000 \\  -->
<!--   rush\_posinteriorLB & 0.058 & 0.011 & 5.332 & 0.000 \\  -->
<!--   rush\_posNT & -0.106 & 0.012 & -9.174 & 0.000 \\  -->
<!--   rush\_posOLB & 0.062 & 0.008 & 7.695 & 0.000 \\  -->
<!--   rush\_possecondary & 0.145 & 0.012 & 12.328 & 0.000 \\  -->
<!--   block\_posC & -0.023 & 0.006 & -3.625 & 0.000 \\  -->
<!--   block\_posG & -0.011 & 0.005 & -2.290 & 0.023 \\  -->
<!--   block\_posother & -0.013 & 0.007 & -1.911 & 0.056 \\  -->
<!--   n\_blockers & -0.064 & 0.003 & -24.788 & 0.000 \\  -->


\begin{table}[ht]
\caption{Intraclass correlation coefficients for the multilevel model for average STRAIN. \label{tab:icc}}
\centering
\begin{tabular}{lr}
\hline
Group & ICC \\ 
\hline
Pass rusher & 0.057 \\ 
Pass blocker & 0.012 \\ 
Quarterback & 0.023 \\ 
Residual & 0.907 \\ 
\hline
\end{tabular}
\end{table}

<!-- We display the random intercepts for pass rusher in Table [INSERT TABLE REFERENCE] alongside their unadjusted STRAIN values.  -->

In addition to adjusting for opposition, our multilevel model allows us to provide some notion of uncertainty about the pass rusher's effect on the play level STRAIN.
Figure \ref{fig:fig_rankings_boot} displays the mean varying intercept for the top ten pass rushers for each position along with 95% confidence intervals. 
We observe similar rankings based on the random intercepts in comparison to the average STRAIN results in Tables \ref{tab:edge} and \ref{tab:interior}, with Myles Garrett (DE), Aaron Donald (DT), Vita Vea (NT), and T.J. Watt (OLB) as the top pass rusher for their respective position. 
We observe different levels of variability across these top players, with the only a subset of players with intervals strictly above zero. This is not necessarily surprising given the limited sample of data. Additionally, we are ignoring correlated performance between pass rushers on the same team, e.g., INSERT TWO PLAYERS ON SAME TEAM, but leave exploration of this for future work.


```{r}
#| label: fig_rankings_boot
#| fig.cap: "Top 10 pass rushers for each position (DE, DT, NT, OLB) by mean varying intercept with 95\\% confidence intervals."
#| fig.width: 6
#| fig.height: 8
source(here("scripts", "10_multilevel_mod.R"))
fig_rankings_boot
```