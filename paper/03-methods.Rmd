# Methods {#sec:methods}

## Motivation and Definition of STRAIN {#sec:defn}

In materials science, strain is the deformation of a material from stress, showing the rate of change in a material's length relative to its original length [@strain].
Formally, let $L(t)$ be the distance between any given two points of interest within a material at time $t$, and $L_0$ be the initial distance between those two points.
The **strain** for a material at time $t$ is defined as 
\begin{equation}
s(t)= \frac{L(t)-L_{0}}{L_{0}}.
\end{equation}
Notice that this measure is unitless due to being a ratio of two quantities having the same dimension.

Accordingly, the **strain rate** of a material measures the change in its deformation with respect to time.
Mathematically, the strain rate of a material can be expressed as the derivative of its strain.
That is,
\begin{equation}
s'(t) = \frac{ds}{dt} = \frac{v(t)}{L_{0}},
\end{equation}
where $v(t)$ is the velocity at which the two points of interest within the material are moving away from or towards each other.
Whereas strain has no units, the strain rate is measured in inverse of time, usually 1/second.

Motivated by its scientific definition, we draw a delightful analogy between strain rate and pass rushing in football.
Just as strain rate is a measure of deformation in materials science, a pass rusher's efforts involve the application of deformation against the offensive line, with the ultimate goal of breaking through the protection to reach the quarterback.
The players can be viewed as "particles" in some material and the defensive "particles" are attempting to exert pressure on the pocket with the aim of compressing and collapsing this pocket around the quarterback.

In order to apply strain rate to measure NFL pass rusher effectiveness, we make modifications to how this concept is traditionally defined.
Let $(x_{ijt}, y_{ijt})$ be the $(x, y)$ location on the field of pass rusher $j = 1, \cdots, J$ at frame $t = 1, \cdots, T_i$ for play $i = 1, \cdots, n$; and $(x^{QB}_{it}, y^{QB}_{it})$ be the $(x, y)$ location of the quarterback at frame $t$ during play $i$.

*   The distance between pass rusher $j$ and the quarterback at frame $t$ during play $i$ is 
\begin{equation}
f_{d_{ij}}(t) = \sqrt{(x_{ijt} - x^{QB}_{it})^2 + (y_{ijt} - y^{QB}_{it})^2}.
\end{equation}
*   The velocity at which pass rusher $j$ is moving towards the quarterback at frame $t$ during play $i$ is 
\begin{equation}
f'_{d_{ij}}(t) = \frac{df_{d_{ij}}(t)}{dt}.
\end{equation}
*   The STRAIN for pass rusher $j$ at frame $t$ during play $i$ is 
\begin{equation}
\text{STRAIN}_{ij}(t) = \frac{-f'_{d_{ij}}(t)}{f_{d_{ij}}(t)}.
\end{equation}

Note that to distinguish our metric from strain and strain rate in materials science, we write it in capital letters (STRAIN) for the remainder of this manuscript.

Recall that based on its materials science property, an increase in strain rate is associated with an increase in the distance between two points.
In the American football setting, the two points of interest are the pass rusher and the quarterback, and we expect our metric to increase as the distance between the pass rusher and the quarterback decreases.
Thus, the negative sign in the numerator of our formula effectively accounts for this. 
Additionally, rather than keeping the initial distance ($L_0$ as previously denoted) between two points constant over time, we update the initial position to be the player locations at the beginning of each frame.
This gives us the STRAIN for each frame throughout a play.

Since we only observe the distance and velocity quantities discretely in increments of 10 frames/second, a point estimate for our proposed metric STRAIN for pass rusher $j$ at frame $t$ during play $i$ is 
\begin{equation}
\widehat{\text{STRAIN}}_{ij}(t) = \cfrac{-\cfrac{f_{d_{ij}}(t) - f_{d_{ij}}(t - 1)}{0.1}}{f_{d_{ij}}(t)}.
\end{equation}
Notice that this quantity increases in two ways: 1) the rate at which the rusher is moving towards the quarterback increases, and 2) the distance between the rusher and the quarterback decreases.
Both of these are indications of an effective pass rush attempt.
Finally, our statistic STRAIN is measured in inverse second, similar to strain rate.
Note that the reciprocal of our metric (1/STRAIN) has an interesting and straightforward interpretation: the amount of time required for the rusher to get to the quarterback at the current location and rate at any given time $t$.

Moreover, since we observe STRAIN at every tenth of a second within each play, we can then compute the average STRAIN across all frames played for every pass rusher.
Formally, the average STRAIN, denoted by $\overline{\text{STRAIN}}$, for pass rusher $j$ involved in $n_j$ total plays across $T_j$ total frames is

\begin{equation}
\overline{\text{STRAIN}}_{j} = \frac{1}{T_j} \sum_{t=1}^{T_j} \widehat{\text{STRAIN}}_{j}(t).
\end{equation}
This can be helpful for player evaluation, as we determine the most effective pass rushers based on their average STRAIN values in Section \ref{sec:strainbar}.
We also use average STRAIN to assess different statistical properties of our metric in Section \ref{sec:statprop}.

## Multilevel Model for Play-Level STRAIN {#sec:multilevel}

<!-- While average STRAIN appears to be positively correlated with pass rusher ability -->

<!-- While average STRAIN is a simple first step for evaluating the pass rush,  -->

In addition to the average STRAIN over all frames played, we can also calculate pass rusher $j$'s observed average STRAIN on a single play $i$ consisting of $T_i$ total frames,
\begin{equation}
\overline{\text{STRAIN}}_{ij} = \frac{1}{T_i} \sum_{t=1}^{T_i} \widehat{\text{STRAIN}}_{ij}(t).
\end{equation}
While this aggregated measure is a simple first step for pass rush evaluation, the observed average STRAIN on a single play is likely due to a convolution of factors.
Outside of the pass rusher's ability, there is variability in the opposing strength of pass blockers across plays a pass rusher is involved.
Additionally, based on previous work by PFF, the opposing QB plays an important role on the observed pressure in passing plays [@eager2019pressure].
Thus, we need to appropriately divide the credit of an observed average STRAIN across the different players involved and other factors.

To this end, we fit a multilevel model to evaluate pass rushers' impact on the average STRAIN observed in a play, while accounting for their pass blocker, QB, and play-level attributes.
We identify the pass blocker linked with the pass rusher of interest using the data provided by PFF.
Since there can be multiple blockers matching up with a rusher, for simplicity, we consider the nearest blocker positioned to the pass rusher at the start of the play.
We use random intercepts for the three player groups: (1) pass rushers as $R$, (2) nearest pass blockers as $B$, and (3) QBs as $Q$.
The coefficients $\boldsymbol \beta$ for covariate vector $\mathbf{x_{ij}}$ for pass rusher $j$ in play $i$ are estimated as fixed-effects. 
Our model for the average STRAIN by pass rusher $j$ on play $i$ is as follows.
\begin{equation}
\begin{aligned}
\overline{\text{STRAIN}}_{ij} &\sim N(R_{j[i]} + B_{b[ij]} + Q_{q[i]} + \mathbf{x_{ij}} \cdot \boldsymbol{\beta}, \sigma^2), \text{ for } i = 1, \dots, n \text{ plays} \\
R_{j} &\sim N(\mu_R, \sigma^2_R), \text{ for } j = 1, \cdots, \text{ \# of pass rushers}, \\
B_{b} &\sim N(\mu_B, \sigma^2_B), \text{ for } b = 1, \cdots, \text{ \# of pass blockers}, \\
Q_{q} &\sim N(\mu_Q, \sigma^2_Q), \text{ for } q = 1, \cdots, \text{ \# of QBs}.
\end{aligned}
\end{equation}

We consider a normal distribution to obtain the random intercepts for each player toward their respective position group means.
This provides us with average individual effects on STRAIN for each player while applying shrinkage, which is a useful property in this problem's context since we do not observe the same number of plays for each player.
With regards to the fixed-effects about pass rusher $j$ in play $i$, we include the length of the play (i.e., the elapsed time between the ball snap and a QB event), the positions of pass rusher and nearest blocker, and the number of pass blockers assigned to the pass rusher based on the PFF data.
Table \ref{tab:pos} shows our positional categorization for the pass rush and pass block roles.
We implement the model using penalized likelihood via the `lme4` package in `R` [@bateslme4; @R2023Language]. Additionally, we generate estimates of uncertainty for the player-level random intercepts based on 95% confidence intervals generated by sampling from the posterior distribution <!-- Posterior distribution of what? --> via parametric bootstrapping with the `merTools` package [@knowlesmerTools; @gelman2006data].

\begin{table}
\caption{Position groupings for pass rushers and blockers. \label{tab:pos}}
\centering
\begin{tabular}{ll}
\hline
Role & Position \\ 
\hline
Pass rush & Defensive end \\ 
Pass rush & Defensive tackle \\ 
Pass rush & Nose tackle \\ 
Pass rush & Outside linebacker \\ 
Pass rush & Interior linebacker (middle linebacker, inside linebacker) \\ 
Pass rush & Secondary (cornerback, free safety, strong safety) \\
\hline
Pass block & Center \\ 
Pass block & Guard \\ 
Pass block & Tackle \\ 
Pass block & Other (tight end, running back, fullback, wide receiver) \\ 
\hline
\end{tabular}
\end{table}

```{r, eval=FALSE}
rush <- tibble(
  Role = "Pass rush",
  Position = c("Defensive end", "Defensive tackle", "Nose tackle", "Outside linebacker",
               "Interior linebacker (middle and inside linebackers)", 
               "Secondary (cornerback, free safety, and strong safety)")
)
block <- tibble(
  Role = "Pass block",
  Position = c("Center", "Guard", "Tackle", "Other (tight end, running back, fullback, wide receiver)")
)
rush |> 
  bind_rows(block) |> 
  xtable()
```

